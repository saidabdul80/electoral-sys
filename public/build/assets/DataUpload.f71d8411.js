import{s as ee,l as N,d as te,B as oe,o as n,c as l,a as h,u as r,i as se,k as S,w as F,F as y,H as ie,b as o,j as b,t as d,y as v,h as B,x as U,m as V,n as W,C as L,D as ne,z as le,A as ae}from"./app.f8b84876.js";import{_ as re}from"./AuthenticatedLayout.c31a01ca.js";import{_ as K,b as M,a as de}from"./TextInput.6e4e088d.js";import{_ as O}from"./PrimaryButton.09d1f117.js";import{L as ce}from"./LightLoader.9cc750dc.js";import{_ as _e}from"./_plugin-vue_export-helper.cdc0426e.js";import"./ApplicationLogo.fb8e71f3.js";const w=c=>(le("data-v-779494bf"),c=c(),ae(),c),ue={class:"row w-100"},pe={class:"col-md-4 pt-2 px-4",style:{height:"82vh"}},fe={class:"d-flex justify-between w-100 my-3 px-3"},me={class:"badge bg-warning"},ge={class:"badge bg-warning"},he={key:1,disabled:"",class:"btn btn-sm px-4 bg-success text-white"},ye={class:"px-3 py-3",style:{background:"#ffffffc7","border-radius":"5px",height:"95%","overflow-y":"scroll"}},be=w(()=>o("li",{class:"label"},"Select States",-1)),ve={class:"list_state"},we=["href"],xe=w(()=>o("li",{class:"label mt-3"}," Settings ",-1)),ke=w(()=>o("label",null,"Election For:",-1)),Se=["value"],Ce=w(()=>o("label",null,"Election Type:",-1)),$e=["value"],Fe={class:"col-md-4 p-0"},Ee={class:"card-v px-2 pt-2"},Ie=["id"],Le={class:"label text-center w-100"},Te=["data-text"],De={style:{width:"100%",margin:"14px 0px 7px 0px","border-bottom":"2px solid #fff","font-weight":"bold"},class:"float-right"},Ae=w(()=>o("table",{class:"w-100"},[o("tbody",null,[o("tr",null,[o("th",{class:"text-center",width:"50%"},"Wards"),o("th",{width:"25%"},"R Voters"),o("th",{width:"25%"},"R Supporters")])])],-1)),Pe=["title"],Ne=["id"],Be={width:"50%",class:"wardTag"},Ue={class:"wardTagText"},Ve={width:"25%"},We=["onKeyup"],Ke={width:"25%"},Me=["onKeyup"],Oe={class:"pt-2"},Re={key:1,disabled:"",class:"btn bg-light mx-1 shadow"},ze={key:3,disabled:"",class:"btn bg-light mx-1 shadow"},He={class:"col-md-4"},je={key:0},qe={key:0},Ge=["onSubmit"],Je=["value"],Qe={class:"flex items-center justify-end mt-4"},Xe=["onSubmit"],Ye=["value"],Ze=w(()=>o("p",null,[o("code",null,"Note:"),b(" This record will be upload with the selected options in settings")],-1)),et={class:"flex items-center justify-end mt-2"},tt={__name:"DataUpload",props:{states:Array,config:Object,msg:{type:String,default:function(){return null}}},setup(c){const f=c,s=ee({ward_id:0,state_id:0,lga_id:0,lgas:[],wards:[],lga_ready:!1,ward_ready:!1,collectedData:{},election_year_id:0,election_month_id:0,election_for_id:0,election_type_id:0,states:[],bParser:{},loading:!1,storedArray:[]}),g=N({state_lga_ward:"",terms:!1}),_=N({records:"",election_for_id:0,election_type_id:0,election_month_id:0,election_year_id:0,terms:!1});function T(i){i.target.parentElement.parentElement.firstElementChild.classList.add("highlight")}function D(i){i.target.parentElement.parentElement.firstElementChild.classList.remove("highlight")}function R(i){let t=i.target.value.toLowerCase();$(".wardTagText").each(function(){$(this).parent().parent().toggle($(this).text().toLowerCase().includes(t))}),$(".lga_container").each(function(){$(this).toggle($(this).attr("data-text").toLowerCase().includes(t))})}function x(i,t){return parseInt(parseInt(t)/parseInt(i)*100)}function z(i,t){if(x(i,t)<40)return"poor";if(x(i,t)>39&&x(i,t)<59)return"normal";if(x(i,t)>58)return"strong"}function A(i,t,u,e){let p=$(e.target).parent().parent().find(":first-child"),m=e.target.parentElement.parentElement.querySelectorAll("input[type=number]"),k=Array.from(m)[0].value,a=Array.from(m)[1].value,I=e.which?e.which:e.keyCode;if(I>31&&(I<48||I>57))return!1;let Y=z(k,a),Z=x(k,a);s.collectedData[i.name+t.id+u.id]={state_id:i.id,lga_id:t.id,ward_id:u.id,total_registered_voters:k,total_registered_supporters:a,election_year_id:f.config.election_year.id,election_month_id:f.config.election_month.id,election_for_id:s.election_for_id,election_type_id:s.election_type_id,created_by:f.config.user.id,flag:Y,percentage:Z,data_token:i.name+t.id+u.id+s.election_type_id+s.election_for_id+f.config.election_month.id+f.config.election_year.id},Array.from(m)[0].value>0&&Array.from(m)[1].value>0?p.addClass("successLight"):p.removeClass("successLight")}const H=()=>{s.loading=!0,L.Inertia.post(route("save_data_entry"),s.collectedData,{onFinish:i=>{s.loading=!1}})},j=async()=>{s.loading=!0;let t=(await ne.post(route("get_saved_data"),s.bParser)).data,u="";$(".r_supports").each(function(){$(this).val("")}),$(".r_voters").each(function(){$(this).val("")}),t.forEach(e=>{u=e.state_id+"_"+e.lga_id+"_"+e.ward_id,$("#"+u).find(".r_supports").val(e.total_registered_supporters),$("#"+u).find(".r_voters").val(e.total_registered_voters)}),s.loading=!1};function ot(i){}function E(i=null,t=null){s.election_for_id!==0&&s.election_type_id!==0&&(s.bParser.election_for_id=s.election_for_id,s.bParser.election_year_id=f.config.election_year.id,s.bParser.election_month_id=f.config.election_month.id,s.bParser.election_type_id=s.election_type_id,s.bParser.user=f.config.user,j()),t=="eF"&&localStorage.setItem("election_for_id",s.election_for_id),t=="eT"&&localStorage.setItem("election_type_id",s.election_type_id)}function C(i){return localStorage.getItem(i)}function q(i,t){for(var u=[],e=0;e<i.length;e++)u.push(i[e][t]);return u}function P(i){alert(i)}te(()=>{s.election_for_id!==0&&s.election_type_id!==0&&E()});const G=async()=>{L.Inertia.visit(s.states.next_page_url,{method:"get"})},J=async()=>{L.Inertia.visit(s.states.prev_page_url,{method:"get"})},Q=()=>{g.post(route("upload_slw"),{onFinish:()=>g})},X=()=>{_.election_for_id=s.election_for_id,_.election_type_id=s.election_type_id,_.election_month_id=f.config.election_month.id,_.election_year_id=f.config.election_year.id,_.post(route("upload_records"),{onFinish:()=>_})};return s.election_for_id=C("election_for_id")==null?0:C("election_for_id"),s.election_type_id=C("election_type_id")==null?0:C("election_type_id"),s.states=f.states,(i,t)=>{const u=oe("spa");return n(),l(y,null,[h(r(ie),{title:"Dashboard"}),s.loading?(n(),se(ce,{key:0})):S("",!0),h(re,null,{default:F(()=>[o("div",ue,[o("div",pe,[o("div",fe,[o("span",null,[b(" Total Lga: "),o("i",me,d(c.config.total_lgas),1),b(" Total Wards: "),o("i",ge,d(c.config.total_wards),1)]),s.election_for_id!==0&&s.election_type_id!==0?(n(),l("button",{key:0,onClick:H,class:"btn btn-sm px-4 bg-success text-white"},"Save")):(n(),l("button",he,"Save"))]),o("ul",ye,[be,o("li",null,[o("ul",ve,[(n(!0),l(y,null,v(s.states.data,e=>(n(),l("li",{key:"s_k"+e.id},[o("a",{href:"#state_"+e.id},d(e.name),9,we)]))),128))])]),xe,o("li",null,[ke,B(o("select",{onChange:t[0]||(t[0]=e=>E(e,"eF")),"onUpdate:modelValue":t[1]||(t[1]=e=>s.election_for_id=e),class:"form-control"},[(n(!0),l(y,null,v(c.config.election_for,e=>(n(),l("option",{key:"el"+e.id,value:e.id},d(e.name),9,Se))),128))],544),[[U,s.election_for_id]])]),o("li",null,[Ce,B(o("select",{onChange:t[2]||(t[2]=e=>E(e,"eT")),"onUpdate:modelValue":t[3]||(t[3]=e=>s.election_type_id=e),class:"form-control"},[(n(!0),l(y,null,v(c.config.election_types,e=>(n(),l("option",{key:"tl"+e.id,value:e.id},d(e.name),9,$e))),128))],544),[[U,s.election_type_id]])])])]),o("div",Fe,[o("input",{type:"text",placeholder:"Search Wards",class:"form-control my-3",onKeyup:t[4]||(t[4]=e=>R(e))},null,32),o("div",Ee,[(n(!0),l(y,null,v(s.states.data,e=>(n(),l("div",{key:"s_"+e.id,id:"state_"+e.id},[o("label",Le,d(e.name)+" State",1),(n(!0),l(y,null,v(e.lgas,p=>(n(),l("div",{class:"lga_container",key:"l_"+p.id,"data-text":[...q(p.wards,"name")]},[o("label",De,d(p.name)+" L.G.A ",1),Ae,o("table",{title:p.name+", "+e.name+" State",class:"clear-float w-100"},[o("tbody",null,[(n(!0),l(y,null,v(p.wards,(m,k)=>(n(),l("tr",{key:"w"+m.id,id:e.id+"_"+p.id+"_"+m.id},[b(d((e.id+""+p.id+m.id,void 0))+" ",1),o("td",Be,[o("span",null,d(k+1)+".",1),o("span",Ue,d(m.name.slice(0,15)),1)]),o("td",Ve,[s.election_for_id!==0&&s.election_type_id!==0?(n(),l("input",{key:0,title:"total registered voters",onFocusout:t[5]||(t[5]=a=>D(a)),onFocus:t[6]||(t[6]=a=>T(a)),onKeyup:a=>A(e,p,m,a),type:"number",min:"0",class:"form-control r_voters"},null,40,We)):(n(),l("input",{key:1,tabindex:"1",onClick:t[7]||(t[7]=a=>P("Select Election Type and Election For to Open this fields")),title:"total registered voters",disabled:"",type:"number",min:"0",class:"form-control"}))]),o("td",Ke,[s.election_for_id!==0&&s.election_type_id!==0?(n(),l("input",{key:0,title:"total supporters",onFocusout:t[8]||(t[8]=a=>D(a)),onFocus:t[9]||(t[9]=a=>T(a)),onKeyup:a=>A(e,p,m,a),type:"number",min:"0",class:"form-control r_supports"},null,40,Me)):(n(),l("input",{key:1,onClick:t[10]||(t[10]=a=>P("Select Election Type and Election For to Open this fields")),title:"total registered Supporters ",disabled:"",type:"number",min:"0",class:"form-control"}))])],8,Ne))),128))])],8,Pe)],8,Te))),128))],8,Ie))),128))]),o("div",Oe,[c.states.prev_page_url!==null?(n(),l("button",{key:0,onClick:J,class:"btn bg-light mx-1 shadow"},"Prev")):(n(),l("button",Re,"Prev")),c.states.next_page_url!==null?(n(),l("button",{key:2,onClick:G,class:"btn bg-light mx-1 shadow"},"Next")):(n(),l("button",ze,"Next")),h(u,null,{default:F(()=>[b(" From State "+d(c.states.from)+" to "+d(c.states.to)+" of "+d(c.states.total),1)]),_:1})])]),o("div",He,[i.$page.props.auth.user?(n(),l("div",je,[i.$page.props.auth.user.role=="admin"?(n(),l("div",qe,[o("form",{onSubmit:V(Q,["prevent"]),enctype:"multipart/form-data"},[o("div",null,[h(K,{for:"state_lga_ward",value:"State Lga Ward File"}),o("input",{id:"state_lga_ward",onInput:t[11]||(t[11]=e=>r(g).state_lga_ward=e.target.files[0]),type:"file",class:"form-control mt-1 block w-full"},null,32),r(g).progress?(n(),l("progress",{key:0,value:r(g).progress.percentage,max:"100"},d(r(g).progress.percentage)+"% ",9,Je)):S("",!0),h(M,{class:"mt-2",message:r(g).errors.state_lga_ward},null,8,["message"])]),o("div",Qe,[h(O,{class:W(["ml-4",{"opacity-25":r(g).processing}]),disabled:r(g).processing},{default:F(()=>[b(" Upload States Lgas Wards ")]),_:1},8,["class","disabled"])])],40,Ge),o("form",{class:"mt-5",onSubmit:V(X,["prevent"]),enctype:"multipart/form-data"},[o("div",null,[h(K,{for:"records",value:"State Lga Ward File"}),h(de,{id:"records",type:"file",class:"form-control mt-1 block w-full",onInput:t[12]||(t[12]=e=>r(_).records=e.target.files[0])}),r(_).progress?(n(),l("progress",{key:0,value:r(_).progress.percentage,max:"100"},d(r(_).progress.percentage)+"% ",9,Ye)):S("",!0),h(M,{class:"mt-2",message:r(_).errors.records},null,8,["message"])]),Ze,o("div",et,[h(O,{class:W(["ml-4",{"opacity-25":r(_).processing}]),disabled:r(g).processing},{default:F(()=>[b(" Upload Record ")]),_:1},8,["class","disabled"])])],40,Xe)])):S("",!0)])):S("",!0)])])]),_:1})],64)}}},ct=_e(tt,[["__scopeId","data-v-779494bf"]]);export{ct as default};
